<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="432px" preserveAspectRatio="none" style="width:1472px;height:432px;background:#FFFFFF;" version="1.1" viewBox="0 0 1472 432" width="1472px" zoomAndPan="magnify"><defs/><g><!--cluster Docker Environment--><g class="cluster" data-entity="Docker Environment" data-source-line="7" data-uid="ent0004" id="cluster_Docker Environment"><rect fill="none" height="267.19" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1;" width="1394" x="72.38" y="159.79"/><path d="M243.1886,159.79 L243.1886,169.0869 L233.1886,179.0869 L72.38,179.0869" fill="none" style="stroke:#696969;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="160.8086" x="75.38" y="173.7851">Docker Environment</text></g><!--entity api--><g class="entity" data-entity="api" data-source-line="8" data-uid="ent0005" id="entity_api"><rect fill="#F1F1F1" height="62.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="118.1621" x="335.3" y="194.79"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="433.4621" y="199.79"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="431.4621" y="201.79"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="431.4621" y="205.79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.1621" x="350.3" y="227.7851">FastAPI API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.9014" x="350.3" y="244.082">(api.py)</text></g><!--entity worker--><g class="entity" data-entity="worker" data-source-line="9" data-uid="ent0006" id="entity_worker"><rect fill="#F1F1F1" height="62.5938" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="166.5605" x="881.1" y="194.79"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1027.6605" y="199.79"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1025.6605" y="201.79"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1025.6605" y="205.79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126.5605" x="896.1" y="227.7851">Extraction Worker</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7939" x="896.1" y="244.082">(worker.py)</text></g><!--entity redis_service--><g class="entity" data-entity="redis_service" data-source-line="10" data-uid="ent0007" id="entity_redis_service"><path d="M560.99,359.39 C560.99,349.39 646.3767,349.39 646.3767,349.39 C646.3767,349.39 731.7634,349.39 731.7634,359.39 L731.7634,400.9838 C731.7634,410.9838 646.3767,410.9838 646.3767,410.9838 C646.3767,410.9838 560.99,410.9838 560.99,400.9838 L560.99,359.39" fill="#00FFFF" style="stroke:#454645;stroke-width:0.5;"/><path d="M560.99,359.39 C560.99,369.39 646.3767,369.39 646.3767,369.39 C646.3767,369.39 731.7634,369.39 731.7634,359.39" fill="none" style="stroke:#454645;stroke-width:0.5;"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.4111" x="570.99" y="386.3851">Redis</text><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150.7734" x="570.99" y="402.682">(Task Queue &amp; State)</text></g><!--entity Client--><g class="entity" data-entity="Client" data-source-line="3" data-uid="ent0002" id="entity_Client"><ellipse cx="394.3751" cy="14" fill="#454645" rx="8" ry="8" style="stroke:#454645;stroke-width:0.5;"/><path d="M394.3751,22 L394.3751,49 M381.3751,30 L407.3751,30 M394.3751,49 L381.3751,64 M394.3751,49 L407.3751,64" fill="none" style="stroke:#454645;stroke-width:0.5;"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="374.11" y="78.4951">Client</text></g><!--entity OpenAI--><g class="entity" data-entity="OpenAI" data-source-line="5" data-uid="ent0003" id="entity_OpenAI"><path d="M971.1098,28.762 C974.4415,19.3633 982.6199,19.1871 987.7847,26.9844 C992.854,19.4343 998.7529,17.2524 1005.0766,25.6218 C1010.4271,19.227 1016.6315,20.8482 1020.1931,27.6682 C1026.2555,21.3628 1032.4401,21.4645 1037.0897,29.3502 C1045.7286,32.9803 1045.53,38.214 1039.4781,44.2059 C1045.0963,49.6843 1044.5224,57.5252 1035.9325,59.7661 C1031.5391,68.4486 1025.8098,69.0676 1020.1955,60.9068 C1016.7951,69.174 1011.1637,72.0496 1004.1321,64.6238 C997.5924,70.614 991.6735,69.8205 988.6599,60.9521 C982.6862,69.9141 976.3581,67.5846 971.6033,59.7168 C963.32,58.7205 959.9713,53.6186 963.4494,45.754 C958.2049,37.5218 961.5747,30.3312 971.1098,28.762" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0986" x="977.83" y="48.4951">OpenAI</text></g><!--link Client to api--><g class="link" data-entity-1="Client" data-entity-2="api" data-source-line="13" data-uid="lnk8" id="link_Client_api"><path d="M373.75,45.75 C309.5,49.67 115.1,65.24 77.38,111.79 C6,199.88 218.8547,219.2833 329.0447,223.6333" fill="none" id="Client-to-api" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="335.04,223.87,326.2048,219.5181,330.0439,223.6728,325.8892,227.5119,335.04,223.87" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.792" x="84.9149" y="124.8569">1. POST /extract_invoice/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.4648" x="90.777" y="139.9897">(file bytes, content_type)</text></g><!--link api to Client--><g class="link" data-entity-1="api" data-entity-2="Client" data-source-line="17" data-uid="lnk10" id="link_api_Client"><path d="M423.17,194.41 C434.62,180.16 446.46,162.29 452.38,143.79 C456.72,130.25 457.34,125.12 452.38,111.79 C444.91,91.72 432.8904,77.6962 419.4004,65.3762" fill="none" id="api-to-Client" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="414.97,61.33,418.9182,70.3529,418.662,64.7018,424.3131,64.4456,414.97,61.33" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.2661" x="473.3346" y="124.8569">3. 202 Accepted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.7783" x="468.777" y="139.9897">(task_id, status_url)</text></g><!--link Client to api--><g class="link" data-entity-1="Client" data-entity-2="api" data-source-line="25" data-uid="lnk16" id="link_Client_api"><path d="M373.85,51.1 C348.93,60.18 308.06,79.33 290.38,111.79 C273.14,143.45 297.9852,169.9258 330.0752,191.0058" fill="none" id="Client-to-api-1" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="335.09,194.3,329.764,186.0155,330.911,191.5548,325.3717,192.7019,335.09,194.3" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.0645" x="291.38" y="124.8569">9. GET /tasks/{task_id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.6758" x="346.7728" y="139.9897">(polling)</text></g><!--link api to Client--><g class="link" data-entity-1="api" data-entity-2="Client" data-source-line="28" data-uid="lnk19" id="link_api_Client"><path d="M453.7,216.53 C530.32,202.88 649,171.45 605.38,111.79 C560.45,50.35 464.7999,43.7553 421.0499,43.9353" fill="none" id="api-to-Client-1" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="415.05,43.96,424.0664,47.9229,420.05,43.9394,424.0335,39.923,415.05,43.96" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.5093" x="653.2819" y="124.8569">12. 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.7837" x="631.9093" y="139.9897">(status, result/error)</text></g><!--link api to redis_service--><g class="link" data-entity-1="api" data-entity-2="redis_service" data-source-line="14" data-uid="lnk9" id="link_api_redis_service"><path d="M334.92,228.2 C236.65,232.04 57.2,248.62 120.38,319.39 C149.13,351.59 412.987,368.4405 554.567,375.2805" fill="none" id="api-to-redis_service" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="560.56,375.57,551.7635,371.1404,555.5658,375.3287,551.3775,379.131,560.56,375.57" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2251" x="183.4982" y="300.4569">2. SET task:{id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.0645" x="133.777" y="315.5897">(status=PENDING, file_b64, type)</text></g><!--link api to redis_service--><g class="link" data-entity-1="api" data-entity-2="redis_service" data-source-line="26" data-uid="lnk17" id="link_api_redis_service"><path d="M384.09,257.65 C379.53,277.32 377.84,302.3 391.38,319.39 C412.39,345.89 489.1317,360.9937 554.7217,369.6637" fill="none" id="api-to-redis_service-1" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="560.67,370.45,552.2718,365.3051,555.7131,369.7948,551.2234,373.2361,560.67,370.45" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.3179" x="392.38" y="307.9569">10. GET task:{id}</text></g><!--link redis_service to api--><g class="link" data-entity-1="redis_service" data-entity-2="api" data-source-line="27" data-uid="lnk18" id="link_redis_service_api"><path d="M592.86,348.9 C578.1,339.91 562.32,329.7 548.38,319.39 C531.17,306.65 530.05,299.47 512.38,287.39 C494.15,274.92 478.3593,266.0077 459.0493,256.3777" fill="none" id="redis_service-to-api" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="453.68,253.7,459.9489,261.2961,458.1545,255.9314,463.5192,254.137,453.68,253.7" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.6689" x="556.702" y="300.4569">11. Return task data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.7837" x="565.9093" y="315.5897">(status, result/error)</text></g><!--link worker to redis_service--><g class="link" data-entity-1="worker" data-entity-2="redis_service" data-source-line="19" data-uid="lnk11" id="link_worker_redis_service"><path d="M880.62,238.66 C836.18,247.38 781.93,262.31 738.38,287.39 C730.85,291.72 703.2491,319.7354 679.1291,344.8154" fill="none" id="worker-to-redis_service" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="674.97,349.14,684.0917,345.4258,678.4359,345.5362,678.3255,339.8804,674.97,349.14" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0469" x="776.5804" y="300.4569">4. GET task:{id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0508" x="751.777" y="315.5897">(or BRPOP pending_tasks)</text></g><!--link worker to redis_service--><g class="link" data-entity-1="worker" data-entity-2="redis_service" data-source-line="20" data-uid="lnk12" id="link_worker_redis_service"><path d="M959.06,257.65 C953.91,278.09 944.01,303.97 925.38,319.39 C896.27,343.46 808.7867,359.2721 737.9867,368.7721" fill="none" id="worker-to-redis_service-1" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="732.04,369.57,741.492,372.3376,736.9956,368.9051,740.4281,364.4086,732.04,369.57" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2251" x="974.7228" y="300.4569">5. SET task:{id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5137" x="960.777" y="315.5897">(status=PROCESSING)</text></g><!--link worker to redis_service--><g class="link" data-entity-1="worker" data-entity-2="redis_service" data-source-line="23" data-uid="lnk15" id="link_worker_redis_service"><path d="M1048.12,247.57 C1096.33,263.28 1142.31,287.66 1114.38,319.39 C1089.57,347.57 866.1577,365.676 737.9977,373.896" fill="none" id="worker-to-redis_service-2" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="732.01,374.28,741.2476,377.6957,736.9997,373.96,740.7355,369.7121,732.01,374.28" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.2251" x="1213.3231" y="300.4569">8. SET task:{id}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.7144" x="1135.777" y="315.5897">(status=COMPLETED/FAILED, result/error)</text></g><!--link worker to OpenAI--><g class="link" data-entity-1="worker" data-entity-2="OpenAI" data-source-line="21" data-uid="lnk13" id="link_worker_OpenAI"><path d="M1012.48,194.31 C1028.97,180.97 1045.49,163.8 1054.38,143.79 C1066.33,116.9 1050.1878,91.3913 1031.7878,71.5313" fill="none" id="worker-to-OpenAI" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="1027.71,67.13,1030.8924,76.4505,1031.1081,70.7978,1036.7609,71.0135,1027.71,67.13" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.3354" x="1096.2025" y="124.8569">6. Call LLM API</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.5835" x="1070.777" y="139.9897">(extracted text, prompt)</text></g><!--link OpenAI to worker--><g class="link" data-entity-1="OpenAI" data-entity-2="worker" data-source-line="22" data-uid="lnk14" id="link_OpenAI_worker"><path d="M962.42,61.95 C941.92,72.97 919.03,89.42 907.38,111.79 C892.83,139.72 908.3667,167.2865 928.4067,190.1665" fill="none" id="OpenAI-to-worker" style="stroke:#454645;stroke-width:1;"/><polygon fill="#454645" points="932.36,194.68,929.4391,185.2742,929.0656,190.9187,923.4211,190.5453,932.36,194.68" style="stroke:#454645;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.8584" x="908.38" y="132.3569">7. Return JSON result</text></g><!--SRC=[VLDTRzD047pthnZo0BNaEX-K0f502ebR0cbiuY1UAbaN-q9FTS_ktJaGHVtlxDbkHVgH1qldyyxixEpubRdYDnmRiL9C6iTXgIaKnhdWzYtDYof3M78vcZhEMZ4gxKoAz9eh178ZL25lgB23dGEanKrPI7e5AmMOHkUCQJEAfg3dKXxHhLzktSvUwPz2MJ9R7VmrYjgBGk9NVKkOvlCzB6E6hPZcK3mJEj5SRKJAQ_32tX1WoVGrVbIyudYDs3332NddECr4E3x-NAiRekyZ2kCbkhnfcmYvAOYjUoa17Ar5ph7Q6guzKYiDWHEpBRdhMBYbsTSmnC1772nXIC1m9xAxXaUJX4f_YeBvP3e_zs1vazNfYOU6xGsvQqTc-H2ZBCDjBRsiz1N46fKMyZTMEJbk3sLHGiZMCuA-A6NbOnRzZB-2DfSHCh6gDAoi1_sj8qEyzJ7e3J1AKruQdZMwBI0HcOTcWAHIkUiuxRQUwtdYu_pf-9IbBuieZFQ5k8U8tXtqSH6EWpWcA_SuceGI-DJ7cEKvPhEB9dKMsswOPp1qz50gYfzndHPb2Lgk8TxxM71JAOblSJWdSRhApI6v7mx97OSNqInO1fFksMWw2oPUIzZbIXNAVIQM7niRkxLFtLsxXfQrBFASJ7mvW_tUeoqu-nN_nR__CAWjhd-jkiczziTIdyIcFx2vwI7yVWZt3m00]--></g></svg>